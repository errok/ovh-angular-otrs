/*! ovh-angular-otrs - 2.0.1 - 2017-08-31 */
angular.module("ovh-angular-otrs",["ovh-api-services","ovh-angular-toaster","ovh-jquery-ui-draggable-ng"]),angular.module("ovh-angular-otrs").controller("OtrsDetailsCtrl",["$stateParams","$translate","OvhApiSupport","OvhApiCloudProject","Toast",function(a,b,c,d,e){"use strict";function f(a){var b;return angular.isString(a)?(b=a.replace(/\[\d{1,2}\](https?:\/\/(\S+))(\s|$)/gi,'<a href="$1" target="_blank">$2</a>$3'),b=b.replace(/\[\d{1,2}\]\s+(https?:\/\/(\S+))(\S+\s*)+$/gi,""),b=b.replace(/([^"']|^)(https?:\/\/([^\/\s]+\/)*([^\/\s]+)\/?)(?!"|')(\s|$)/gi,'$1<a href="$2" target="_blank">$4</a>$5'),b=b.replace(/(\[\d{1,2}\])?(\s)?([a-zA-Z0-9!#$%&'*+\/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+\/=?^_`{|}~-]+)*@(?:[a-zA-Z0-9](?:[a-zA-Z0-9-]*[a-zA-Z0-9])?\.)+[a-zA-Z0-9]{2}(?:[a-zA-Z0-9-]*[a-zA-Z0-9])?)(\s|$)/gi,'$2<a href="mailto:$3">$3</a>$4'),a===b?null:b):null}function g(){c.Lexi().resetCache(),c.Lexi().get({id:i.ticket.ticketId}).$promise.then(function(a){a.serviceName&&"publiccloud"===a.product?d.Lexi().get({serviceName:a.serviceName}).$promise.then(function(b){b&&b.description&&(a.serviceDescription=b.description)})["finally"](function(){angular.extend(i.ticket,a)}):angular.extend(i.ticket,a)},function(a){e.error([(b.instant("otrs_err_get_infos"),a.data&&a.data.message||"")].join(" "))})["finally"](function(){i.loaders.ticket=!1})}function h(){i.loaders.messages=!0,c.Lexi().getMessages({id:i.ticket.ticketId}).$promise.then(function(a){i.messages=a;for(var b=0,c=a.length;c>b;b++)a[b].bodyCook=f(a[b].body),a[b].displayBodyCook=!!a[b].bodyCook},function(a){e.error([(b.instant("otrs_err_get_infos"),a.data&&a.data.message||"")].join(" "))})["finally"](function(){i.loaders.messages=!1})}var i=this;i.reply=function(){!i.loaders.reply&&i.answer.body&&(i.loaders.reply=!0,c.Lexi().reply({id:i.ticket.ticketId},{body:i.answer.body}).$promise.then(function(){i.answer.body=null,g(),h()},function(a){e.error([(b.instant("otrs_detail_reply_error"),a.data&&a.data.message||"")].join(" "))})["finally"](function(){i.loaders.reply=!1}))},i.closeTicket=function(){i.loaders.close||(i.loaders.close=!0,c.Lexi().close({id:i.ticket.ticketId},{}).$promise.then(function(){i.$onInit()},function(a){e.error([(b.instant("otrs_detail_close_error"),a.data&&a.data.message||"")].join(" "))})["finally"](function(){i.loaders.close=!1}))},i.reopenTicket=function(){i.loaders.close||(i.loaders.close=!0,i.loaders.reply=!0,c.Lexi().reopen({id:i.ticket.ticketId},{body:i.answer.body}).$promise.then(function(){i.answer.body=null,i.$onInit()},function(a){e.error([(b.instant("otrs_detail_reopen_error"),a.data&&a.data.message||"")].join(" "))})["finally"](function(){i.loaders.close=!1,i.loaders.reply=!1}))},this.$onInit=function(){this.ticket={ticketId:a.id},this.messages=[],this.loaders={ticket:!0,messages:!0,close:!1,reply:!1},this.answer={body:null},g(),h()}}]),angular.module("ovh-angular-otrs").config(["$stateProvider",function(a){"use strict";a.state("otrs-details",{url:"/support/{id:int}/details",templateUrl:"app/module-otrs/details/otrs-details.html",controller:"OtrsDetailsCtrl",controllerAs:"OtrsDetailsCtrl",translations:["common","module-otrs","module-otrs/details"]})}]),angular.module("ovh-angular-otrs").constant("OTRS_POPUP_ASSISTANCE_ENUM",{USAGE:"usage",START:"start",NEW:"new",OTHER:"other"}).constant("OTRS_POPUP_BILLING_ENUM",{INPROGRESS:"inProgress",NEW:"new",BILL:"bill",OTHER:"other"}).constant("OTRS_POPUP_INCIDENT_ENUM",{PERFS:"perfs",ALERTS:"alerts",DOWN:"down"}).constant("OTRS_POPUP_INTERVENTION_ENUM",{REPLACEMENTDISK:"replacement-disk",OTHER:"other"}).constant("OTRS_POPUP_CATEGORIES",{ASSISTANCE:"assistance",BILLING:"billing",INCIDENT:"incident",INTERVENTION:"intervention"}).constant("OTRS_POPUP_SERVICES",{DOMAIN:"DOMAIN",HOSTING:"HOSTING",EMAIL:"EMAIL_DOMAIN",ZONE:"ZONE",SQL:"PRIVATE_DATABASE",EXCHANGE:"EXCHANGE",OFFICE_365:"OFFICE_365",VPS:"VPS",LOAD_BALANCER:"LOAD_BALANCER",FAILOVER:"FAILOVER",CLOUD:"CLOUD",CDN:"CDN_WEBSTORAGE",DEDICATED:"DEDICATED",CDN_DEDICATED:"CDN_DEDICATED"}).constant("OTRS_POPUP_UNIVERSES",{EU:["CLOUD_DEDICATED","SUNRISE","TELECOM","WEB"],CA:["CLOUD_DEDICATED","SUNRISE"],US:["CLOUD_DEDICATED"]}),angular.module("ovh-angular-otrs").controller("OtrsPopupCtrl",["$rootScope","$stateParams","$translate","$q","OvhApiMeVipStatus","OvhApiMe","OvhApiSupport","OvhApiProductsAapi","Toast","OtrsPopupService","UNIVERSE","TICKET_CATEGORIES","OTRS_POPUP_ASSISTANCE_ENUM","OTRS_POPUP_BILLING_ENUM","OTRS_POPUP_INCIDENT_ENUM","OTRS_POPUP_INTERVENTION_ENUM","OTRS_POPUP_UNIVERSES",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){"use strict";function r(){s.ticket={body:null,serviceName:null,subject:null,type:null},s.universes=q.EU;var a="GAMMA"===k?"SUNRISE":k;s.selectedUniverse=_.includes(["CLOUD","DEDICATED"],a)||!a?"CLOUD_DEDICATED":a}var s=this,t="other";a.$on("$stateChangeSuccess",function(a,b,c){c.projectId&&s.services&&-1!==s.services.indexOf(c.projectId)&&(s.ticket.serviceName=c.projectId)}),s.sendTicket=function(){!s.loaders.send&&s.ticket.body&&(s.loaders.send=!0,s.ticket.serviceName===t&&(s.ticket.serviceName="",s.ticket.category=l.DEFAULT),g.Lexi().create(s.ticket).$promise.then(function(b){r(),s.otrsPopupForm.$setUntouched(),s.otrsPopupForm.$setPristine(),a.$broadcast("ticket.otrs.reload"),j.close(),i.success(c.instant("otrs_popup_sent_success",{ticketNumber:b.ticketNumber,ticketId:b.ticketId}))},function(a){i.error([(c.instant("otrs_popup_sent_error"),a.data&&a.data.message||"")].join(" "))})["finally"](function(){s.loaders.send=!1}))},s.getServices=function(){s.loaders.services=!0,s.services=[],h.get({includeInactives:!0,universe:"CLOUD_DEDICATED"===s.selectedUniverse?"DEDICATED":s.selectedUniverse}).$promise.then(function(a){var b=a.results.map(function(a){return c("otrs_service_category_"+a.name,null,null,a.name).then(function(b){return a.translatedName=b,a})});return d.all(b).then(function(a){a=a.sort(function(a,b){return a.translatedName.localeCompare(b.translatedName)}),a.push({translatedName:c.instant("otrs_service_category_other"),services:[{serviceName:t,displayName:c.instant("otrs_service_category_other")}]}),s.services=a})})["catch"](function(a){i.error([(c.instant("otrs_err_get_infos"),a.data&&a.data.message||"")].join(" "))})["finally"](function(){s.loaders.services=!1})},this.$onInit=function(){r(),s.loaders={send:!1,models:!0},s.isVIP=!1,s.getServices(),d.all([f.Lexi().get().$promise,g.Lexi().schema().$promise]).then(function(a){s.types=a[1].models["support.TicketTypeEnum"]["enum"],s.categories=a[1].models["support.TicketProductEnum"]["enum"],s.requests=a[1].models["support.TicketCategoryEnum"]["enum"],s.subCategories={assistance:[m.USAGE,m.START],billing:[n.INPROGRESS,n.BILL],incident:[o.PERFS,o.ALERTS,o.DOWN],intervention:[p.REPLACEMENTDISK,p.OTHER]},"FR"!==a[0].ovhSubsidiary&&(s.subCategories.assistance.splice(2,0,m.NEW),s.subCategories.assistance.splice(3,0,m.OTHER),s.subCategories.billing.splice(1,0,m.NEW),s.subCategories.billing.splice(3,0,m.OTHER),s.subCategories.incident.splice(3,0,m.OTHER)),1===s.categories.length&&(s.ticket.product=s.categories[0])})["catch"](function(a){i.error([(c.instant("otrs_err_get_infos"),a.data&&a.data.message||"")].join(" "))})["finally"](function(){s.loaders.models=!1}),e.Lexi().get().$promise.then(function(a){s.isVIP=-1!==_.values(a.toJSON()).indexOf(!0)})}}]),angular.module("ovh-angular-otrs").directive("otrsPopup",function(){"use strict";return{restrict:"A",scope:{},replace:!1,templateUrl:"app/module-otrs/otrs-popup/otrs-popup.html",link:function(a){a.status={minimize:!1,maximize:!1,close:!1},a.minimize=function(){a.status.maximize=!1,a.status.minimize=!0,a.status.close=!1},a.maximize=function(){a.status.maximize=!0,a.status.minimize=!1,a.status.close=!1},a.restore=function(){a.status.maximize=!1,a.status.minimize=!1,a.status.close=!1},a.toggle=function(){a.status.maximize||a.status.minimize?a.restore():a.maximize()},a.close=function(){a.restore(),a.status.close=!0},a.$on("otrs.popup.maximize",a.maximize),a.$on("otrs.popup.minimize",a.minimize),a.$on("otrs.popup.restore",a.restore),a.$on("otrs.popup.toggle",a.toggle),a.$on("otrs.popup.close",a.close)}}}),angular.module("ovh-angular-otrs").service("OtrsPopupService",["$rootScope","$compile",function(a,b){"use strict";var c=this,d=["minimize","maximize","restore","close"],e=!1;angular.forEach(d,function(b){c[b]=function(c){a.$broadcast("otrs.popup."+b,c)}}),this.toggle=function(){$("[otrs-popup] .draggable").hasClass("close")?c.restore():c.close()},this.init=function(){b("<div otrs-popup></div>")(a,function(a){$("body").append(a),e=!0})},this.isLoaded=function(){return e}}]),angular.module("ovh-angular-otrs").controller("OtrsCtrl",["$scope","$timeout","$q","OvhApiSupport","OvhApiProductsAapi","$translate","Toast","OtrsPopupService","UNIVERSE",function(a,b,c,d,e,f,g,h,i){"use strict";var j=this;j.loaders={table:!1},j.tickets={ids:[],detail:[]},j.cloudProjects=[],j.status=["open","closed"],j.filters={minCreationDate:"",maxCreationDate:"",serviceName:null,status:"",subject:null,product:null},j.search={open:!1},j.itemsPerPage=10,j.init=function(){e.get({includeInactives:!0,universe:i.toLowerCase()}).$promise.then(function(a){var b=a.results.map(function(a){return f("otrs_service_category_"+a.name,null,null,a.name).then(function(b){return a.translatedName=b,a})});return c.all(b).then(function(a){j.services=a,j.cloudProjects=a.find(function(a){return"PROJECT"===a.name}),1===j.services.length&&(j.ticket.serviceName=j.services[0])})})["catch"](function(a){g.error([(f.instant("otrs_err_get_infos"),a.data&&a.data.message||"")].join(" "))}),d.Lexi().schema().$promise.then(function(a){j.types=a.models["support.TicketTypeEnum"]["enum"],j.categories=a.models["support.TicketCategoryEnum"]["enum"]},function(a){g.error([(f.instant("otrs_err_get_infos"),a.data&&a.data.message||"")].join(" "))}),j.getTickets()},a.$watch("OtrsCtrl.filters",function(){b(function(){j.getTickets()},0)},!0),j.getTickets=function(a){j.loaders.table=!0;var b=angular.copy(j.filters);b.minCreationDate=""===b.minCreationDate?null:b.minCreationDate,b.maxCreationDate=""===b.maxCreationDate?null:b.maxCreationDate,b.status=""===b.status?null:b.status,b.subject&&(b.subject=window.encodeURIComponent(b.subject)),a&&d.Lexi().resetQueryCache(),d.Lexi().query(b).$promise.then(function(a){_.isEqual(j.tickets.ids,a)?j.loaders.table=!1:(0===a.length&&(j.loaders.table=!1),j.tickets.ids=a)},function(a){g.error([(f.instant("otrs_err_get_infos"),a.data&&a.data.message||"")].join(" "))})["finally"](function(){j.loaders.table=!1})},j.transformItem=function(a){return j.loaders.table=!0,d.Lexi().get({id:a}).$promise.then(function(a){return a.serviceDescription=j.getServiceDescription(a),a})},j.getServiceDescription=function(a){var b;if(!_.isEmpty(j.cloudProjects)){var c=j.cloudProjects.services.find(function(b){return b.serviceName===a.serviceName});_.isEmpty(c)||(b=c.displayName)}return b},j.onTransformItemDone=function(){j.loaders.table=!1},a.$on("ticket.otrs.reload",function(){j.getTickets(!0)}),j.openDialog=function(){h.isLoaded()?h.toggle():h.init()},j.init()}]),angular.module("ovh-angular-otrs").config(["$stateProvider",function(a){"use strict";a.state("otrs-list",{url:"/support",controller:["$window","MANAGER_URLS",function(a,b){a.open(b.dedicated+"ticket","_self")}]})}]),angular.module("ovh-angular-otrs").constant("TICKET_CATEGORIES",{LIST:{WEB:["cdn","domain","exchange","hosting","mail","ssl","vps","web-billing","web-other"],TELECOM:["adsl","voip","fax","sms","telecom-billing","telecom-other"],DEDICATED:["dedicated","dedicatedcloud","housing","dedicated-other","dedicated-billing"],CLOUD:["publiccloud"]},DEFAULT:"billing"}),angular.module("ovh-angular-otrs").run(["$templateCache",function(a){"use strict";a.put("app/module-otrs/details/otrs-details.html",'<section class=otrs-details><header><a class=section-back-link data-ui-sref=otrs-list title="{{ ::\'otrs_back_to_list\' | translate}}"><i class="ovh-font ovh-font-arrow-left"></i> <span data-translate=otrs_detail_title></span></a><h1 data-translate=otrs_detail_tiket_title data-translate-values="{id: OtrsDetailsCtrl.ticket.ticketNumber}"></h1></header><div class=otrs-details><div class="row top-space-m20 text-center" data-ng-show="OtrsDetailsCtrl.loaders.ticket || OtrsDetailsCtrl.loaders.messages"><spinner></spinner></div><div class="row top-space-m20" data-ng-hide=OtrsDetailsCtrl.loaders.ticket><div class=col-md-9><div data-ng-hide="OtrsDetailsCtrl.loaders.ticket === true" class=row><div class=col-md-6><p class=wordbreak><strong data-translate=otrs_detail_subject></strong> <span data-ng-bind=OtrsDetailsCtrl.ticket.subject></span></p><p class=wordbreak><strong data-translate=otrs_detail_serviceName></strong> <span data-ng-bind="OtrsDetailsCtrl.ticket.serviceDescription || OtrsDetailsCtrl.ticket.serviceName || i18n.otrs_service_other_services | translate"></span></p><p data-ng-if=ticket.product><strong data-translate=otrs_popup_category></strong> <span data-ng-bind="( \'otrs_category_\' + OtrsDetailsCtrl.ticket.product | translate)  || OtrsDetailsCtrl.ticket.product"></span></p><p><strong data-translate=otrs_popup_type></strong> <span data-ng-bind="( \'otrs_types_\' + OtrsDetailsCtrl.ticket.type | translate) || OtrsDetailsCtrl.ticket.type"></span></p></div><div class=col-md-6><p><strong class=bold data-translate=otrs_detail_creationDate></strong> <span data-ng-bind="OtrsDetailsCtrl.ticket.creationDate | date : \'short\'"></span></p><p><strong data-translate=otrs_detail_updateDate></strong> <span data-ng-bind="OtrsDetailsCtrl.ticket.updateDate | date : \'short\'"></span></p></div></div></div><div class="col-md-3 col-xs-12" data-ng-hide="OtrsDetailsCtrl.loaders.messages === true"><button type=button class="btn btn-primary col-xs-12" data-ng-click=OtrsDetailsCtrl.closeTicket() data-ng-disabled="OtrsDetailsCtrl.loaders.close || OtrsDetailsCtrl.loaders.reply" data-ng-if="OtrsDetailsCtrl.ticket.state !== \'closed\'"><i class="glyphicon glyphicon-lock" aria-hidden=true></i> <span data-translate=otrs_detail_close></span></button></div></div><div class=row data-ng-hide=OtrsDetailsCtrl.loaders.messages><div class="col-md-9 col-xs-12"><div data-ng-repeat="message in OtrsDetailsCtrl.messages | orderBy:\'creationDate\' track by $index"><div class="col-md-10 col-xs-12" data-ng-class="{\'ovh-message\': message.from !== \'customer\', \'customer-message col-md-offset-2\': message.from === \'customer\'}"><div class=bold><span data-ng-bind="(\'otrs_detail_from_\' + message.from | translate)"></span> <button type=button class="btn pull-right" data-ng-if=message.bodyCook data-ng-click="message.displayBodyCook = !message.displayBodyCook"><span data-ng-show=message.displayBodyCook><small data-translate=otrs_detail_raw_version class=hidden-xs></small> <i class="glyphicon glyphicon-eye-close" aria-hidden=true></i> </span><span data-ng-hide=message.displayBodyCook><small data-translate=otrs_detail_cook_version class=hidden-xs></small> <i class="glyphicon glyphicon-eye-open" aria-hidden=true></i></span></button></div><pre data-ng-show=message.displayBodyCook data-ng-bind-html=message.bodyCook></pre><pre data-ng-hide=message.displayBodyCook data-ng-bind=message.body></pre><div class=pull-right data-ng-bind="message.creationDate | date:\'short\'"></div></div></div></div></div><div class=row data-ng-hide=OtrsDetailsCtrl.loaders.messages><div class="col-md-9 col-xs-12"><textarea data-ng-model=OtrsDetailsCtrl.answer.body style="width: 100%" rows=4 data-ng-disabled=OtrsDetailsCtrl.loaders.reply></textarea><p class=italic data-ng-if="OtrsDetailsCtrl.ticket.state !== \'closed\'" data-translate=otrs_detail_info></p><p class=italic data-ng-if="OtrsDetailsCtrl.ticket.state === \'closed\'" data-translate=otrs_detail_info2></p></div><div class="col-md-3 col-xs-12"><button class="btn btn-primary col-xs-12" data-ng-click=OtrsDetailsCtrl.reply() type=button data-ng-disabled="OtrsDetailsCtrl.loaders.reply || !OtrsDetailsCtrl.answer.body || OtrsDetailsCtrl.loaders.close" data-ng-if="OtrsDetailsCtrl.ticket.state !== \'closed\'"><spinner data-ng-show=OtrsDetailsCtrl.loaders.reply class=pull-left></spinner><i class="glyphicon glyphicon-share-alt" aria-hidden=true></i> <span data-translate=otrs_detail_reply></span></button> <button type=button class="btn btn-primary col-xs-12" data-ng-click=OtrsDetailsCtrl.reopenTicket() data-ng-disabled="OtrsDetailsCtrl.loaders.reply || !OtrsDetailsCtrl.answer.body || OtrsDetailsCtrl.loaders.close" data-ng-if="OtrsDetailsCtrl.ticket.state === \'closed\'"><spinner data-ng-show=OtrsDetailsCtrl.loaders.reply class=pull-left></spinner><i class="glyphicon glyphicon-repeat" aria-hidden=true></i> <span data-translate=otrs_detail_reopen></span></button></div></div></div></section>'),a.put("app/module-otrs/otrs-popup/otrs-popup.html","<div data-draggable class=\"draggable otrs-popup\" options=\"{containment: 'body', handle: '#headerPopup, #contentPopup form' }\" data-ng-class=\"{\n        'minimize' : status.minimize,\n        'maximize' : status.maximize,\n        'close'    : status.close\n"+'    }"><div class=draggable-header id=headerPopup><span data-translate=otrs_popup_title></span><div class="otrs_popup_tools pull-right"><button type=button aria-label="{{\'otrs_popup_icon_minimize\' | translate}}" data-ng-click=minimize()><i class="fa fa-window-minimize" aria-hidden=true></i></button> <button type=button aria-label="{{\'otrs_popup_icon_maximize\' | translate}}" data-ng-click=toggle()><i class="fa fa-window-maximize" aria-hidden=true></i></button> <button type=button aria-label="{{\'otrs_popup_icon_close\' | translate}}" data-ng-click=close()><i class="fa fa-close" aria-hidden=true></i></button></div></div><div id=contentPopup data-ng-controller="OtrsPopupCtrl as OtrsPopupCtrl"><p class="italic fs10 center bottom-space" data-translate=otrs_popup_move></p><p class="text-center bottom-space" data-ng-if=OtrsPopupCtrl.isVIP><em data-translate=otrs_vip_phone></em></p><form name=OtrsPopupCtrl.otrsPopupForm id=otrsPopupForm novalidate data-ng-submit=OtrsPopupCtrl.sendTicket() class="ovh-form-flat animate-opacity2-leave"><div class=col-xs-12><div class=row><div class=col-xs-12><label class=control-label for=select-universe data-translate=otrs_universe_choice></label></div></div><div class="flat-input-container row"><div class=col-xs-12><select flat-select id=select-universe name=select-universe class=form-control required data-ng-model=OtrsPopupCtrl.selectedUniverse data-ng-options="universe as ( \'otrs_universe_\'+ universe | translate ) for universe in OtrsPopupCtrl.universes" data-ng-change=OtrsPopupCtrl.getServices()></select></div></div></div><div class=col-xs-12><div class=row><div class=col-xs-12><label class=control-label for=select-services data-translate=otrs_popup_service></label><spinner data-ng-show=OtrsPopupCtrl.loaders.services class=pull-right></spinner></div></div><div class="flat-input-container row"><div class=col-xs-12><select flat-select id=select-services name=select-services class=form-control required data-ng-model=OtrsPopupCtrl.ticket.serviceName data-ng-disabled=OtrsPopupCtrl.loaders.services><optgroup data-ng-repeat="category in OtrsPopupCtrl.services track by $index" label="{{ category.translatedName }}"><option data-ng-repeat="service in category.services track by $index" value="{{ service.serviceName }}" data-ng-bind=service.displayName></option></optgroup></select></div></div></div><div class=col-xs-12 data-ng-if=OtrsPopupCtrl.isVIP><div class=row><div class=col-xs-12><label class=control-label for=select-types translate=otrs_popup_type></label><spinner data-ng-show=OtrsPopupCtrl.loaders.models class=pull-right></spinner></div></div><div class="flat-input-container row"><div class=col-xs-12><select flat-select id=select-types name=select-types class=form-control data-ng-model=OtrsPopupCtrl.ticket.type data-ng-options="type as ( \'otrs_types_\'+type | translate ) for type in OtrsPopupCtrl.types" data-ng-disabled=OtrsPopupCtrl.loaders.models></select></div></div></div><div class=col-xs-12><div class=row><div class=col-xs-12><label class=control-label for=select-requests translate=otrs_category_choice></label><spinner data-ng-show=OtrsPopupCtrl.loaders.models class=pull-right></spinner></div></div><div class="flat-input-container row"><div class=col-xs-12><select flat-select id=select-requests name=select-requests class=form-control required data-ng-model=OtrsPopupCtrl.ticket.category data-ng-options="request as ( \'otrs_category_\'+request | translate ) for request in OtrsPopupCtrl.requests" data-ng-disabled=OtrsPopupCtrl.loaders.models></select></div></div></div><div class=col-xs-12 data-ng-show=OtrsPopupCtrl.ticket.category><div class=row><div class=col-xs-12><label class=control-label for=select-subCategories translate=otrs_subCategory_choice></label><spinner data-ng-show=OtrsPopupCtrl.loaders.models class=pull-right></spinner></div></div><div class="flat-input-container row"><div class=col-xs-12><select flat-select id=select-subCategories name=select-requests class=form-control required data-ng-model=OtrsPopupCtrl.ticket.subcategory data-ng-options="subCategory as (\'otrs_subCategory_\' + OtrsPopupCtrl.ticket.category + \'_\' + subCategory | translate) for subCategory in OtrsPopupCtrl.subCategories[OtrsPopupCtrl.ticket.category]" data-ng-disabled=OtrsPopupCtrl.loaders.models></select></div></div></div><div class=col-xs-12><div flat-input-container><div class=row><div class=col-xs-12><label class=control-label for=txt-subject>{{\'otrs_popup_subject\' | translate}}</label></div></div><div class=row><div class=col-xs-12><input id=txt-subject name=txt-subject class=form-control data-ng-model=OtrsPopupCtrl.ticket.subject required placeholder="{{\'otrs_popup_subject\' | translate}}"></div></div></div></div><div class=col-xs-12><div flat-input-container><div class=row><div class=col-xs-12><label class=control-label for=txt-message>{{\'otrs_popup_body\' | translate}}</label></div></div><div class=row><div class=col-xs-12><textarea id=txt-message name=txt-message class=form-control rows=8 required data-ng-model=OtrsPopupCtrl.ticket.body placeholder="{{\'otrs_popup_body\' | translate}}">\n                            </textarea></div></div></div></div><div class="col-xs-12 top-space-m12"><button type=submit class="btn btn-primary col-xs-12" data-ng-disabled="!OtrsPopupCtrl.otrsPopupForm.$valid || OtrsPopupCtrl.loaders.services || OtrsPopupCtrl.loaders.send"><i class="glyphicon glyphicon-envelope" aria-hidden=true></i> <span translate=otrs_popup_add_ticket></span><spinner data-ng-show=OtrsPopupCtrl.loaders.send class=left-space-m20></spinner></button></div></form></div></div>'),a.put("app/module-otrs/otrs.html",'<div class=module-otrs><header class=module-otrs-title><h1 data-translate=otrs_menu_ticket_list_title></h1></header><div class=module-otrs-content><div class=row><div class=col-xs-12><div class=clearfix><button type=button class="btn btn-search pull-right" data-ng-class="{ \'visibility-hide\' : OtrsCtrl.loaders.table }" data-ng-click="OtrsCtrl.search.open = !OtrsCtrl.search.open"><i data-ng-hide=OtrsCtrl.search.open class="fa fa-search right-space-m8" aria-hidden=true></i> <i data-ng-show=OtrsCtrl.search.open class="fa fa-times right-space-m8" aria-hidden=true></i> {{\'otrs_filters_button\' | translate}}</button> <button type=button class="btn btn-primary pull-right right-space-m8" data-ng-class="{ \'visibility-hide\' : OtrsCtrl.loaders.table}" data-ng-click=OtrsCtrl.openDialog()><i class="glyphicon glyphicon-plus right-space-m8" aria-hidden=true></i> {{\'otrs_menu_ticket_create\' | translate}}</button></div><form name=searchTicketsForm novalidate data-ng-slide-down=OtrsCtrl.search.open duration=0.3 data-ng-show=OtrsCtrl.search.open class="ovh-form-flat animate-opacity2-leave"><div class="top-space-p4 clearfix row"><div class="col-md-3 col-xs-12 col-md-offset-3 col-xs-offset-0"><div class=row><div class=col-xs-12><label class=control-label for=select-services data-translate=otrs_ticket_service></label></div></div><div class="flat-input-container row"><div class=col-xs-12><select flat-select id=select-services name=select-services class=form-control data-ng-model=OtrsCtrl.filters.serviceName><option value="" data-translate=otrs_no_filter></option><optgroup data-ng-repeat="category in OtrsCtrl.services | orderBy: \'translatedName\' track by $index" label="{{ category.translatedName }}"><option data-ng-repeat="service in category.services track by $index" value="{{ service.serviceName }}" data-ng-bind=service.displayName></option></optgroup></select></div></div></div><div class="col-md-3 col-xs-12"><div class=row><div class=col-xs-12><label class=control-label for=select-state data-translate=otrs_ticket_state></label></div></div><div class="flat-input-container row"><div class=col-xs-12><select flat-select id=select-state name=select-state class=form-control data-ng-model=OtrsCtrl.filters.status data-ng-options="status as (\'otrs_ticket_state_\' + status | translate) for status in OtrsCtrl.status"><option value="" data-translate=otrs_no_filter></option></select></div></div></div><div class="col-md-3 col-xs-12"><div class=row><div class=col-xs-12><label class=control-label for=select-categories data-translate=otrs_ticket_category></label></div></div><div class=row flat-input-container><div class=col-xs-12><select flat-select id=select-categories name=select-categories class=form-control data-ng-model=OtrsCtrl.filters.category data-ng-options="category as (\'otrs_category_\'+category | translate) for category in OtrsCtrl.categories"><option value="" data-translate=otrs_no_filter></option></select></div></div></div></div><div class="top-space-p4 clearfix row"><div class="col-md-3 col-xs-12 col-md-offset-6 col-xs-offset-0"><div class=row><div class=col-xs-12><label class=control-label for=date-creation-start data-translate=otrs_ticket_date_creation_include></label></div></div><div class=row flat-input-container><div class=col-xs-12><div class=input-group><div class=input-group-addon><i class="fa fa-calendar" aria-hidden=true></i></div><input class="form-control datepicker-ui-pretty" id=date-creation-start name=date-creation-start data-uib-datepicker-popup=shortDate data-is-open=openedCreationStart data-ng-click="openedCreationStart = true" data-ui-validate-watch="\'OtrsCtrl.search.creationEnd\'" data-ui-validate="{ \'startBeforeEndDate\' : \'!$value\n                                                                 || !OtrsCtrl.filters.maxCreationDate\n                                                                 || OtrsCtrl.filters.maxCreationDate > $value\' }" data-ng-model=OtrsCtrl.filters.minCreationDate data-ng-disabled=OtrsCtrl.loaders.table><div class=input-group-btn data-ng-show=OtrsCtrl.filters.minCreationDate><button type=button class="no-style btn" data-ng-click="OtrsCtrl.filters.minCreationDate = null" data-ng-disabled=OtrsCtrl.loaders.table><i class="fa fa-times" aria-hidden=true></i></button></div></div></div></div></div><div class="col-md-3 col-xs-12"><div class=row><div class=col-xs-12><label class=control-label for=date-creation-end data-translate=otrs_ticket_date_creation_exclude></label></div></div><div class=row flat-input-container><div class=col-xs-12><div class=input-group><div class=input-group-addon><i class="fa fa-calendar" aria-hidden=true></i></div><input class="form-control datepicker-ui-pretty" id=date-creation-end name=searchCreationEnd data-uib-datepicker-popup=shortDate data-is-open=openedCreationEnd data-ng-click="openedCreationEnd = true" data-ng-model=OtrsCtrl.filters.maxCreationDate data-ui-validate-watch="\'OtrsCtrl.filters.minCreationDate\'" data-ui-validate="{\'startBeforeEndDate\' : \'!$value\n                                                                 || !OtrsCtrl.filters.minCreationDate\n                                                                 || OtrsCtrl.filters.minCreationDate < $value\' }" data-ng-disabled=OtrsCtrl.loaders.table><div class=input-group-btn data-ng-show=OtrsCtrl.filters.maxCreationDate><button type=button class="no-style btn" data-ng-click="OtrsCtrl.filters.maxCreationDate = null" data-ng-disabled=OtrsCtrl.loaders.table><i class="fa fa-times" aria-hidden=true></i></button></div></div></div></div></div></div></form><div class="table-responsive-vertical shadow-z-1 top-space-m12"><table class="table table-pretty table-hover table-striped"><thead><tr><th data-translate=otrs_ticket_number></th><th data-translate=otrs_ticket_service></th><th data-translate=otrs_ticket_category></th><th data-translate=otrs_ticket_type></th><th data-translate=otrs_ticket_suject></th><th data-translate=otrs_ticket_last_message_from></th><th data-translate=otrs_ticket_date_creation></th><th data-translate=otrs_ticket_date_update></th><th data-translate=otrs_ticket_state></th><th class=text-center><button type=button class=no-style data-ng-click=OtrsCtrl.getTickets(true)><i class="glyphicon glyphicon-refresh" aria-hidden=true></i></button></th></tr></thead><tbody data-ng-show=OtrsCtrl.loaders.table><tr><td colspan=10 class=text-center><spinner></spinner></td></tr></tbody><tbody data-ng-if="!OtrsCtrl.loaders.table && OtrsCtrl.tickets.ids.length === 0"><tr><td colspan=10 class=text-center><span data-translate=otrs_ticket_empty></span></td></tr></tbody><tbody data-ng-hide=OtrsCtrl.loaders.table><tr data-ng-repeat="ticket in OtrsCtrl.tickets.detail track by $index" class=row-clickable><td data-title="{{::\'otrs_ticket_number\' | translate}}" class=word-break><a ui-sref="otrs-details({id: ticket.ticketId})" data-ng-bind=ticket.ticketNumber></a></td><td data-title="{{::\'otrs_ticket_service\' | translate}}" class=word-break><a ui-sref="otrs-details({id: ticket.ticketId})" data-ng-bind="ticket.serviceDescription || ticket.serviceName || \'otrs_service_category_other\' | translate"></a></td><td data-title="{{::\'otrs_ticket_category\' | translate}}" class=word-break><a ui-sref="otrs-details({id: ticket.ticketId})" data-ng-bind="\'otrs_category_\' + ticket.category | translate"></a></td><td data-title="{{::\'otrs_ticket_type\' | translate}}" class=word-break><a ui-sref="otrs-details({id: ticket.ticketId})" data-ng-bind="\'otrs_types_\' + ticket.type | translate"></a></td><td data-title="{{::\'otrs_ticket_suject\' | translate}}" class=word-break><a ui-sref="otrs-details({id: ticket.ticketId})" data-ng-bind=ticket.subject></a></td><td data-title="{{::\'otrs_ticket_last_message_from\' | translate}}" class=word-break><a ui-sref="otrs-details({id: ticket.ticketId})" data-ng-bind="\'otrs_ticket_lastMessageFrom_\' + ticket.lastMessageFrom | translate"></a></td><td data-title="{{::\'otrs_ticket_date_creation\' | translate}}" class=word-break><a ui-sref="otrs-details({id: ticket.ticketId})" data-ng-bind="ticket.creationDate | date:\'short\'"></a></td><td data-title="{{::\'otrs_ticket_date_update\' | translate}}" class=word-break><a ui-sref="otrs-details({id: ticket.ticketId})" data-ng-bind="ticket.updateDate | date:\'short\'"></a></td><td data-title="{{::\'otrs_ticket_state\' | translate}}" class=word-break><a ui-sref="otrs-details({id: ticket.ticketId})" data-ng-bind="\'otrs_ticket_state_\' + ticket.state | translate"></a></td><td class=text-center><a ui-sref="otrs-details({id: ticket.ticketId})"><i class="glyphicon glyphicon-search" aria-hidden=true></i></a></td></tr></tbody></table></div><div class=table-pretty-pagination data-pagination-front data-items=OtrsCtrl.tickets.ids data-paginated-items=OtrsCtrl.tickets.detail data-current-page=currentPage data-items-per-page=OtrsCtrl.itemsPerPage data-nb-pages=nbPages data-transform-item=OtrsCtrl.transformItem(item) data-on-transform-item-done=OtrsCtrl.onTransformItemDone(items) data-page-placeholder="{{ \'common_pagination_page\' | translate:{currentPage: currentPage, nbPages : nbPages} }}" data-item-per-page-placeholder="{{ \'common_pagination_display\' | translate }}"></div></div></div></div></div>')}]);